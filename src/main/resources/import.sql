-- ESTE SCRIPT DE CREACION PARA EL TEST FUE MODIFICADO PARA UN MOTOR DE BASES DE DATOS POSTGRESQL EN SU VERSION 10
-- PostgreSQL 10.10 (Ubuntu 10.10-0ubuntu0.18.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0, 64-bit

CREATE TABLE SERVICIOS (
	ID NUMERIC(10,0),
	DESCRIPCION CHARACTER VARYING(30),
	COMISION NUMERIC(3,0),
	ESTADO CHARACTER VARYING(2) ,
	CONSTRAINT SERV_PK PRIMARY KEY (ID),
	CONSTRAINT SERV_ESTADO_CK CHECK (ESTADO IN ('AC', 'IN'))
);

CREATE TABLE CLIENTES (
	ID NUMERIC(10,0),
	TIPO_DOCUMENTO CHARACTER VARYING(3),
	NUMERO_DOCUMENTO CHARACTER VARYING(10),
	NOMBRE_COMPLETO CHARACTER VARYING(60),
	CONSTRAINT CLIE_PK PRIMARY KEY (ID),
	CONSTRAINT CLIE_TIPO_DOCU_CK CHECK (TIPO_DOCUMENTO IN ('CI', 'RUC'))
);

CREATE TABLE DEUDAS (
	SERVICIO_ID NUMERIC(10,0),
	FACTURA CHARACTER VARYING(30),
	CLIENTE_ID NUMERIC(10,0),
	IMPORTE NUMERIC(15,2),
	VENCIMIENTO DATE,
	ESTADO CHARACTER VARYING(2),
	CONSTRAINT DEUD_PK PRIMARY KEY (SERVICIO_ID, FACTURA),
	CONSTRAINT DEUD_SERVICIO_FK FOREIGN KEY (SERVICIO_ID) REFERENCES SERVICIOS (ID),
	CONSTRAINT DEUD_CLIENTES_FK FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTES (ID),
	CONSTRAINT DEUD_ESTADO_CK CHECK (ESTADO IN ('PE', 'CO'))
);

CREATE TABLE TRANSACCIONES (
	ID NUMERIC(10,0),
	SERVICIO_ID NUMERIC(10,0),
	FACTURA CHARACTER VARYING(30),
	FECHA DATE,
	IMPORTE NUMERIC(15,2),
	COMISION NUMERIC(15,2),
	CONSTRAINT TRAN_PK PRIMARY KEY (ID),
	CONSTRAINT TRAN_DEUDA_FK FOREIGN KEY (SERVICIO_ID, FACTURA) REFERENCES DEUDAS (SERVICIO_ID, FACTURA)
);

INSERT INTO SERVICIOS (ID, DESCRIPCION, COMISION, ESTADO) VALUES (1, 'ANDE', 10, 'AC');
INSERT INTO SERVICIOS (ID, DESCRIPCION, COMISION, ESTADO) VALUES (2, 'ESSAP', 12, 'AC');
INSERT INTO SERVICIOS (ID, DESCRIPCION, COMISION, ESTADO) VALUES (3, 'COPACO', 15, 'AC');
INSERT INTO SERVICIOS (ID, DESCRIPCION, COMISION, ESTADO) VALUES (4, 'VOX', 4, 'AC');
INSERT INTO SERVICIOS (ID, DESCRIPCION, COMISION, ESTADO) VALUES (5, 'TIGO', 5, 'AC');
INSERT INTO SERVICIOS (ID, DESCRIPCION, COMISION, ESTADO) VALUES (6, 'PERSONAL', 4, 'AC');
INSERT INTO SERVICIOS (ID, DESCRIPCION, COMISION, ESTADO) VALUES (7, 'CLARO', 3, 'IN');

INSERT INTO CLIENTES (ID, TIPO_DOCUMENTO, NUMERO_DOCUMENTO, NOMBRE_COMPLETO) VALUES(1, 'CI', '123456', 'CHUCK NORRIS');
INSERT INTO CLIENTES (ID, TIPO_DOCUMENTO, NUMERO_DOCUMENTO, NOMBRE_COMPLETO) VALUES(2, 'CI', '234567', 'BRUCE WAYNE');
INSERT INTO CLIENTES (ID, TIPO_DOCUMENTO, NUMERO_DOCUMENTO, NOMBRE_COMPLETO) VALUES(3, 'CI', '345678', 'PETER PARKER');
INSERT INTO CLIENTES (ID, TIPO_DOCUMENTO, NUMERO_DOCUMENTO, NOMBRE_COMPLETO) VALUES(4, 'CI', '456789', 'BOB ESPONJA');
INSERT INTO CLIENTES (ID, TIPO_DOCUMENTO, NUMERO_DOCUMENTO, NOMBRE_COMPLETO) VALUES(5, 'CI', '567890', 'NIKOLA TESLA');
INSERT INTO CLIENTES (ID, TIPO_DOCUMENTO, NUMERO_DOCUMENTO, NOMBRE_COMPLETO) VALUES(6, 'CI', '543210', 'ESTEBAN QUITO');
INSERT INTO CLIENTES (ID, TIPO_DOCUMENTO, NUMERO_DOCUMENTO, NOMBRE_COMPLETO) VALUES(7, 'RUC', '222-2', 'JUAN PEREZ');

INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000001', 1, 7, 10000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000002', 2, 6, 13000, current_date-10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000003', 3, 5, 20000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000004', 4, 4, 23000, current_date+20,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000005', 5, 3, 15000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000006', 6, 2, 18000, current_date+30,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000007', 7, 1, 25000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000008', 1, 2, 12000, current_date+20,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000009', 2, 3, 11000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000010', 3, 4, 16000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000011', 4, 5, 17000, current_date+30,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000012', 5, 6, 32000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000013', 6, 7, 19000, current_date+20,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000014', 7, 6, 59000, current_date+30,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000015', 1, 5, 98000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000016', 2, 4, 20000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000017', 3, 3, 76000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000018', 4, 2, 67000, current_date+20,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000019', 5, 1, 87000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000020', 6, 2, 79000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000021', 7, 3, 56000, current_date-10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000022', 1, 4, 23000, current_date+30,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000023', 2, 5, 46000, current_date+20,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000024', 3, 6, 21000, current_date+30,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000025', 4, 7, 26000, current_date+20,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000026', 5, 6, 67000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000027', 6, 5, 86000, current_date+50,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000028', 7, 4, 97000, current_date+40,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000029', 1, 3, 99000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000030', 2, 2, 87000, current_date+30,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000031', 3, 1, 88000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000032', 4, 2, 77000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000033', 5, 3, 98000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000034', 6, 4, 91000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000035', 7, 5, 71000, current_date+20,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000036', 1, 6, 65000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000037', 2, 6, 28000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000038', 3, 7, 49000, current_date+30,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000039', 4, 6, 59000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000040', 5, 5, 72000, current_date+20,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000041', 1, 4, 10000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000042', 2, 3, 13000, current_date+50,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000043', 3, 2, 20000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000044', 4, 1, 23000, current_date+30,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000045', 5, 2, 15000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000046', 6, 3, 18000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000047', 7, 3, 25000, current_date+20,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000048', 1, 5, 12000, current_date+30,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000049', 2, 6, 11000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000050', 3, 7, 16000, current_date+20,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000051', 4, 6, 17000, current_date+30,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000052', 5, 5, 32000, current_date+20,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000053', 6, 4, 19000, current_date+20,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000054', 7, 3, 59000, current_date+30,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000055', 1, 2, 91000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000056', 2, 1, 22000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000057', 3, 2, 73000, current_date+30,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000058', 4, 3, 64000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000059', 5, 4, 85000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000060', 6, 5, 76000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000061', 7, 6, 57000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000062', 1, 7, 28000, current_date-20,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000063', 2, 6, 49000, current_date-30,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000064', 3, 5, 20000, current_date-20,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000065', 4, 4, 29000, current_date-10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000066', 5, 3, 68000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000067', 6, 2, 87000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000068', 7, 1, 96000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000069', 1, 2, 95000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000070', 2, 3, 84000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000071', 3, 4, 83000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000072', 4, 5, 72000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000073', 5, 6, 91000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000074', 6, 7, 90000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000075', 7, 6, 79000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000076', 1, 5, 68000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000077', 2, 4, 27000, current_date+10,'PE');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000078', 3, 3, 46000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000079', 4, 2, 54000, current_date+10,'CO');
INSERT INTO DEUDAS (FACTURA, SERVICIO_ID, CLIENTE_ID, IMPORTE, VENCIMIENTO, ESTADO) VALUES ('001-001-000080', 5, 1, 71000, current_date+10,'PE');

CREATE temp sequence temp_seq;
INSERT INTO TRANSACCIONES (ID, SERVICIO_ID, FECHA, FACTURA, IMPORTE, COMISION)
SELECT nextval('temp_seq') as ROWNUM, SERVICIO_ID, current_date, FACTURA, IMPORTE, 0
FROM DEUDAS
WHERE ESTADO = 'CO';

-- ACTUALIZAR LAS COMISIONES DE LAS TRANSACCIONES
DO $$
DECLARE REG RECORD;
BEGIN
  FOR REG IN (
    SELECT ID, COMISION
    FROM SERVICIOS
  ) LOOP
      UPDATE TRANSACCIONES
      SET COMISION = ROUND(REG.COMISION * IMPORTE / 100)
      WHERE SERVICIO_ID = REG.ID;
    END LOOP;
END; $$
